# iGOAT
# The workflow of iGOAT
iGOAT was developed by integrating multiple-omics data from a variety of sources with gene networks to predict high-risk genes associated with the disease. 

1. We first collected disease-associated SNPs from genome-wide associations studies (GWAS). Each SNP were assigned candidate genes by considering SNP-to-gene distances and chromatin interactions. Briefly, a gene was considered to be a candidate gene effected by a given SNP if the gene intersected with 1Mb of the SNP, or the SNP interacted with the transcriptional start site (TSS) of the gene according to Hi-C data. We considered the SNP to be capable of interacting with the TSS if the interaction region in Hi-C data was within 250kb to the SNP. 
2. Each candidate gene was annotated in terms of multi-omics features. Here, the multi-omics data we collected for each gene include distance to index SNP (DTS), the significance of differential expression (DE) in patients and controls, signals of enhancer-promoter interactions (EPI) from specific cell type and developmental stage. All missing data in these data sources were filled in by means of the K-Nearest Neighbors algorithm. 
3. Cumulative distribution of each feature in a set of candidate genes was used to score the genes. In short, if a gene x_i was an element of a candidate gene set for a given disease, the feature j of gene x_i was given by x_ij. We used the percentile rank of x_ij in the feature j to represent the score of the gene x_i for feature j, which was denoted as p_(x_ij ). Then, these scores were converted to -log scale. The summation of these scores yielded the final weight of gene ![1](http://latex.codecogs.com/svg.latex?\int_a^bf(x)\ dx) (Equation (1)). 
![image](https://user-images.githubusercontent.com/67153388/177130371-34759708-6daf-4f74-a56d-4c8d1b1cd73e.png)

where n is the total number of features for gene x_i, and D_(x_i ) represents the genomic data for gene x_i. p_xij=C_(x_ij )/M, where C_(x_ij ) is the cumulative frequency of genes with scores higher than or equal to the score of the gene of interest x_i on feature j (if the lower score means the higher risk of functional impact on the gene, C_(x_ij ) is the cumulative frequency of genes with scores lower than or equal to the score of the gene of interest x_i on feature j), and M is the total number of candidate genes for a certain disorder. The gene scores were integrated with gene network weights, P(x_i│X,N), in which X denotes the set of candidate genes already selected (x_i∉X), and N refers to the constructed gene networks containing GO network, PPI network and SNP-SNP interactions. The detailed construction of the gene network could be found in the supplementary material attached to the article. 
4. P(x_i│D,N)=P(x_i│X,N)P(D_(x_i )│x_i ) is used as prior probabilities (sampled probabilities¬¬) in Gibbs sampling to maximize the probability of selecting a set of genes. The probability of selecting a set of genes based on m selected genes in Gibbs sampling is shown in Equation (2). 
P(x_1,x_2,…,x_m│D,N)=∏_(i=1,2,…,m)▒〖P(x_i│X,N)P(D_(x_i ) |x_i)〗  (2),
where [x_1,x_2,…,x_m] denotes genes to be selected and X refers to the m selected genes in the previous round ({x_1,x_2,…,x_m}∩X=∅). The conditional probability was used as sampled weight in Gibbs sampling to generate the posterior probabilities (PP) of candidate genes. 
5. A null distribution of the posterior probability was built for each candidate in order to identify high-risk genes (HRGs) and low-risk genes (LRGs). 
# Data format
In order to run iGOAT, the input data are required in specific format. 
1.GWAS file: the file is required to at least contain three columns, “SNP”, “chr”, and “Pos_hg19”. “SNP” represents identity ID of GWAS SNP; “chr” represents chromosome where SNP is located; “Pos_hg19” represents position of SNP in hg19.
2. DE file: each row contains a gene symbol and the P value to show significance of gene expression difference.
3. HiC file for candidate gene selection: each row contains position of TSS, the interaction bin start and end, gene name for the TSS;
4. HiC file for charactering candidate genes: each row contains a gene symbol and the number of enhancer-promoter interactions for this gene’s promoter.
5. Network file: The gene network file is a positive-definite matrix and is required in Rdata format. 
6. Output file: each row contains gene symbol, index SNP, sampled probability of candidate gene in Gibbs sampling, posterior probability (PP) value, times of the gene being selected in Gibbs sampling and other basic information for the gene.
7. Input of null distribution: using candidate_genes file generated in iGOAT.R.
8. Running example: gene2 <- iGOAT("PD","All_human_genes")
# Acknowledgement
We thank for all the available data for supporting this work. The Hic data used for selecting candidate genes was from publication of “Chromosome conformation elucidates regulatory relationships in developing human brain” (Nature. 2016;538(7626):523-7). Data used for EPI were downloaded from publication of “Brain cell type-specific enhancer-promoter interactome maps and disease-risk association” (Science. 2019;366(6469):1134-9) and “Comprehensive functional genomic resource and integrative model for the human brain” (Science. 2018;362(6420)). The eQTL file used for the initial start in Gibbs’ sampling was downloaded from “An xQTL map integrates the genetic architecture of the human brain's transcriptome and epigenome” (Nat Neurosci. 2017;20(10):1418-26) and “Unraveling the polygenic architecture of complex traits using blood eQTL metaanalysis” (bioRxiv. 2018:447367). The weighted SNP-SNP interactions was generated by using data in UK Biobank.
# Note
All position information used here was based on genome hg19. Users can generate the files containing p values of genes differential expression analysis by using RNA-seq data from any other resources. The HiC data used in this study have been organized into the format containing gene-promoter interactions. Briefily, each row of the file for Hi-C data includes gene symoble and the number promoters interacting with the gene. Since the networks used in the article are from multiple scoures and are too huge to be uploaded in github, anyone who wants the file please email me at hedan5@mail2.sysu.edu.cn.
# Language
R (100%)
